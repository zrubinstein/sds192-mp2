---
title: "Mini-Project 2"
author: "Julia Hamilton, Zoe Rubinstein, Jessica Tin"
date: "March 26, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE, echo=FALSE}
# Load the data
load("candidates.rda")
load("contributions.rda")
library(tidyverse)
```

```{r}
candidates1 <- candidates %>%
  filter(cand_office_state=="PA") %>%
  select(cand_id, cand_party_affiliation, cand_election_yr, cand_city, cand_zip) %>%
  rename(zip_code = cand_zip)

contributions1 <- contributions %>%
  filter(state=="PA", transaction_type=="24E") %>%
  select(cand_id, transaction_amt)

money <- inner_join(candidates1, contributions1, by="cand_id")
money<-money%>%
  mutate(zip_code=as.numeric(zip_code))
```

```{r}
zip <- read.csv("~/Desktop/zip_codes.csv")

zip <- zip %>%
  select(Zip_Code, County) %>%
  rename(zip_code = Zip_Code) %>%
  mutate(County=toupper(County))

money1 <- inner_join(money, zip, by="zip_code")

pa <- map_data("state", region = "pennsylvania")
pa_counties <- map_data("county", region = "pennsylvania")

pa_counties <- pa_counties %>%
  mutate(subregion=toupper(subregion)) %>%
  rename(County=subregion)

bigmoney <- inner_join(money1, pa_counties, by="County")

reps <- bigmoney %>%
  filter(cand_party_affiliation=="REP")
dems <- bigmoney %>%
  filter(cand_party_affiliation=="DEM")
```


```{r}
library(maps)

# Load PA state and county data
pa <- map_data("state") %>%
  subset(region == "pennsylvania")
counties <- map_data("county") %>%
  subset(region == "pennsylvania")

# Get the state boundaries
pa_map <- ggplot(data = pa, mapping = aes(x = long, y = lat, group = group)) +
  geom_polygon(color = "black", fill = "gray") +
  ggtitle("Pennsylvania Contributions Supporting Republican Candidates by County")

# Distinguish county boundaries of the state
pa_map +
  geom_polygon(data = counties, color = "white", fill = NA) +
  geom_polygon(color = "black", fill = NA)
```